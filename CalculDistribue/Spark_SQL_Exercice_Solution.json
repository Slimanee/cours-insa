{"paragraphs":[{"text":"%md\nRead a text file into a dataframe:\n\n```scala\nval df: DataFrame = spark.read.textFile(\"/path/to/file\")\n```","user":"anonymous","dateUpdated":"2019-02-13T17:23:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read a text file into a dataframe:</p>\n<pre><code class=\"scala\">val df: DataFrame = spark.read.textFile(&quot;/path/to/file&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1550078607960_954871004","id":"20190212-181349_1658792420","dateCreated":"2019-02-13T17:23:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:236"},{"text":"%md\nPrint a sample of a Dataframe:\n\n```scala\ndf.show()\ndf.show(10)\ndf.show(20, truncate = true)\ndf.show(false)\n```","user":"anonymous","dateUpdated":"2019-02-13T17:23:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Print a sample of a Dataframe:</p>\n<pre><code class=\"scala\">df.show()\ndf.show(10)\ndf.show(20, truncate = true)\ndf.show(false)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1550078607965_-1914891741","id":"20190212-181524_1986011006","dateCreated":"2019-02-13T17:23:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:237"},{"text":"%md\nSelect a column from dataframe:\n\n```scala\ndf.select($\"value\").show()\ndf.select(\"value\").show()\n```","user":"anonymous","dateUpdated":"2019-02-13T17:35:04+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550078607968_-283214191","id":"20190212-181606_121197231","dateCreated":"2019-02-13T17:23:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238","dateFinished":"2019-02-13T17:35:04+0000","dateStarted":"2019-02-13T17:35:04+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Select a column from dataframe:</p>\n<pre><code class=\"scala\">df.select($&quot;value&quot;).show()\ndf.select(&quot;value&quot;).show()\n</code></pre>\n</div>"}]}},{"text":"%md\nApply a function to a column:\n\n```scala\ndf.select(substring($\"value\", 0, 1) as \"letter\")\ndf.createOrReplaceTempView(\"lines\")\nspark.sql(\"SELECT SUBSTRING(value, 0, 1) AS letter FROM lines\")\n```","user":"anonymous","dateUpdated":"2019-02-13T17:41:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550079304033_-2052047710","id":"20190213-173504_1697226348","dateCreated":"2019-02-13T17:35:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2184","dateFinished":"2019-02-13T17:41:02+0000","dateStarted":"2019-02-13T17:41:02+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Apply a function to a column:</p>\n<pre><code class=\"scala\">df.select(substring($&quot;value&quot;, 0, 1) as &quot;letter&quot;)\ndf.createOrReplaceTempView(&quot;lines&quot;)\nspark.sql(&quot;SELECT SUBSTRING(value, 0, 1) AS letter FROM lines&quot;)\n</code></pre>\n</div>"}]}},{"text":"%md\nSort a dataframe:\n\n```scala\ndf.orderBy($\"letter\" asc)\n```","user":"anonymous","dateUpdated":"2019-02-13T18:15:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550081462218_1472093284","id":"20190213-181102_949297421","dateCreated":"2019-02-13T18:11:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10356","dateFinished":"2019-02-13T18:15:05+0000","dateStarted":"2019-02-13T18:15:05+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Sort a dataframe:</p>\n<pre><code class=\"scala\">df.orderBy($&quot;letter&quot; asc)\n</code></pre>\n</div>"}]}},{"text":"%md\nApply an aggregation function:\n\n```scala\ndf\n    .groupBy($\"letter\")\n    .agg(sum($\"occurences\"))\n```","user":"anonymous","dateUpdated":"2019-02-13T18:18:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550081842637_-622140487","id":"20190213-181722_2141501622","dateCreated":"2019-02-13T18:17:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10446","dateFinished":"2019-02-13T18:18:44+0000","dateStarted":"2019-02-13T18:18:44+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Apply an aggregation function:</p>\n<pre><code class=\"scala\">df\n    .groupBy($&quot;letter&quot;)\n    .agg(sum($&quot;occurences&quot;))\n</code></pre>\n</div>"}]}},{"text":"","user":"anonymous","dateUpdated":"2019-02-13T18:19:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550079599089_1309729963","id":"20190213-173959_969664611","dateCreated":"2019-02-13T17:39:59+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2467"}],"name":"Spark_SQL_Exercice","id":"2E6DCGK6M","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}