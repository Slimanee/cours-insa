{"paragraphs":[{"text":"%md\nRead a text file with rdd API:\n\n```scala\nval rdd: RDD[String] = sc.textFile(\"/path/to/file\")\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read a text file with rdd API:</p>\n<pre><code class=\"scala\">val rdd: RDD[String] = sc.textFile(&quot;/path/to/file&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549992258687_-164483630","id":"20190212-172418_216014798","dateCreated":"2019-02-12T17:24:18+0000","dateStarted":"2019-02-12T18:09:35+0000","dateFinished":"2019-02-12T18:09:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13679"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549992374722_907138751","id":"20190212-172614_897570704","dateCreated":"2019-02-12T17:26:14+0000","dateStarted":"2019-02-12T17:34:28+0000","dateFinished":"2019-02-12T17:34:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13680"},{"text":"%md\nPeek RDD content:\n\n```scala\nrdd.take(3)\n```\n\nGet full RDD content:\n\n```scala\nrdd.collect()\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Peek RDD content:</p>\n<pre><code class=\"scala\">rdd.take(3)\n</code></pre>\n<p>Get full RDD content:</p>\n<pre><code class=\"scala\">rdd.collect()\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549993686745_1797812903","id":"20190212-174806_1981194390","dateCreated":"2019-02-12T17:48:06+0000","dateStarted":"2019-02-12T18:09:35+0000","dateFinished":"2019-02-12T18:09:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13681"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549993756919_-105278931","id":"20190212-174916_845814054","dateCreated":"2019-02-12T17:49:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13682"},{"text":"%md\nApply one function to a RDD:\n\n```scala\ndef size(string: String): Int = {\n    string.length\n}\n\nval intRDD: RDD[Int] = rdd.map(s => size(s))\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Apply one function to a RDD:</p>\n<pre><code class=\"scala\">def size(string: String): Int = {\n    string.length\n}\n\nval intRDD: RDD[Int] = rdd.map(s =&gt; size(s))\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549992782337_1883740143","id":"20190212-173302_612403158","dateCreated":"2019-02-12T17:33:02+0000","dateStarted":"2019-02-12T18:09:35+0000","dateFinished":"2019-02-12T18:09:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13683"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549993055743_-2063836770","id":"20190212-173735_657734948","dateCreated":"2019-02-12T17:37:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13684"},{"text":"%md\nFiltering a RDD[Int]:\n```scala\nval filteredRDD: RDD[Int] = rdd.filter(i => i > 56)\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Filtering a RDD[Int]:</p>\n<pre><code class=\"scala\">val filteredRDD: RDD[Int] = rdd.filter(i =&gt; i &gt; 56)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549993059945_-277121687","id":"20190212-173739_2058466725","dateCreated":"2019-02-12T17:37:39+0000","dateStarted":"2019-02-12T18:09:36+0000","dateFinished":"2019-02-12T18:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13685"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549993157374_373146018","id":"20190212-173917_427847771","dateCreated":"2019-02-12T17:39:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13686"},{"text":"%md\nCreate a PairRDD:\n```scala\nval pairRDD: RDD[(String, Int)] = rdd.map(line => (line, line.length))\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Create a PairRDD:</p>\n<pre><code class=\"scala\">val pairRDD: RDD[(String, Int)] = rdd.map(line =&gt; (line, line.length))\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549993185715_1104921045","id":"20190212-173945_1125460051","dateCreated":"2019-02-12T17:39:45+0000","dateStarted":"2019-02-12T18:09:36+0000","dateFinished":"2019-02-12T18:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13687"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549993362629_-2088394961","id":"20190212-174242_1342951581","dateCreated":"2019-02-12T17:42:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13688"},{"text":"%md\nReduce an RDD[Int]:\n\n```scala\nval product: Int = rdd.reduce((a, b) => a * b)\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Reduce an RDD[Int]:</p>\n<pre><code class=\"scala\">val product: Int = rdd.reduce((a, b) =&gt; a * b)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549993360105_1831347242","id":"20190212-174240_1287245802","dateCreated":"2019-02-12T17:42:40+0000","dateStarted":"2019-02-12T18:09:36+0000","dateFinished":"2019-02-12T18:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13689"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549993536947_656737685","id":"20190212-174536_12780041","dateCreated":"2019-02-12T17:45:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13690"},{"text":"%md\nSort RDD[(Int, String, String)] values by third tuple value in ascending order:\n\n```scala\nrdd.sortBy(t => t._3, true)\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Sort RDD[(Int, String, String)] values by third tuple value in ascending order:</p>\n<pre><code class=\"scala\">rdd.sortBy(t =&gt; t._3, true)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549993540357_-96716324","id":"20190212-174540_300491054","dateCreated":"2019-02-12T17:45:40+0000","dateStarted":"2019-02-12T18:09:36+0000","dateFinished":"2019-02-12T18:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13691"},{"text":"","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549994624755_-222178975","id":"20190212-180344_1703484012","dateCreated":"2019-02-12T18:03:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13692"},{"text":"%md\nSave a RDD into a file:\n\n```scala\nrdd.saveAsTextFile(\"/zeppelin/files/output.txt\")\n```","user":"anonymous","dateUpdated":"2019-02-12T18:09:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Save a RDD into a file:</p>\n<pre><code class=\"scala\">rdd.saveAsTextFile(&quot;/zeppelin/files/output.txt&quot;)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1549994628593_1216639690","id":"20190212-180348_2011816741","dateCreated":"2019-02-12T18:03:48+0000","dateStarted":"2019-02-12T18:09:36+0000","dateFinished":"2019-02-12T18:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13693"},{"text":"val rdd = sc.textFile(\"/zeppelin/files/sample.txt\")\nval words = rdd\n    .flatMap(_.split(\" \"))\n    .map(_.replace(\".\", \"\").replace(\",\", \"\").replace(\"sed\", \"awk\"))\n    .filter(_.nonEmpty)\n    .cache()\n\nval size = words.count()\n\nval result = words\n    .map((_, 1))\n    .reduceByKey(_ + _)\n    .map(t => (t._1, t._2, t._2 * 100.0 / size))\n    .sortBy(_._2, false)\n\nresult\n    .map(t => s\"${t._1}, ${t._2}, ${t._3}\")\n    .saveAsTextFile(\"/zeppelin/files/output.txt\")","user":"anonymous","dateUpdated":"2019-02-12T18:11:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rdd: org.apache.spark.rdd.RDD[String] = /zeppelin/files/sample.txt MapPartitionsRDD[14] at textFile at <console>:25\nwords: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[17] at filter at <console>:29\nsize: Long = 150156\nresult: org.apache.spark.rdd.RDD[(String, Int, Double)] = MapPartitionsRDD[23] at sortBy at <console>:38\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1549994436408_-427057105","id":"20190212-180036_316389454","dateCreated":"2019-02-12T18:00:36+0000","dateStarted":"2019-02-12T18:11:15+0000","dateFinished":"2019-02-12T18:11:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13694"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549995006125_-1044172273","id":"20190212-181006_1066041618","dateCreated":"2019-02-12T18:10:06+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:13695"}],"name":"Spark_RDD_Exercice_Solution","id":"2E46916VU","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}